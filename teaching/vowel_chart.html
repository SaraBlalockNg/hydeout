<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vowel Trapezoid</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Charis+SIL&display=swap">
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: flex-start;  /* Align at the top */
            flex-direction: column;  /* Stack the elements vertically */
            height: 100vh;
            margin: 50 50 50 50;
            background-color: white;
        }
        p {
            display: block; /* Ensures paragraphs are block-level and not inline */
            margin-bottom: 10px; /* Adds space between paragraphs */
        }
        button {
            margin-top: 20px; /* Adds space between the chart and the button */
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            text-align: center;
            gap: 20px; /* Space between elements */
        }
        svg {
            width: 550px;
            height: 400px;
            border: none;
        }
        .node {
            fill: black;
            cursor: pointer;
        }
        input {
            width: 25px;
            height: 30px;
            text-align: center;
            font-size: 24px;
            position: absolute;
            background-color: white; /* Makes the background see-through */
            border: none; /* Removes the border */
            font-family: 'Charis SIL', serif; /* Apply Charis SIL font */

        }
    </style>
</head>
<body>
    <div><h1>Interactive IPA Vowel Trapezoid</h1>
    <p>This is an interative IPA chart, which you can edit to suit the phonetic or phonological inventory of your language. You can click on each vowel to edit its symbol; erase the value of that vowel to remove it from the inventory.</p>
    <p>It is recommended to make separate monophthong and diphthong charts. Drawing arrows for diphthongs is not currently supported.</p></div>
    <br>
 
    <div class="container">
        <svg viewBox="0 0 650 400">

            <text x="150" y="30" font-size="24" font-family="Charis SIL, serif" text-anchor="middle">Front</text>
            <text x="375" y="30" font-size="24" font-family="Charis SIL, serif" text-anchor="middle">Central</text>
            <text x="600" y="30" font-size="24" font-family="Charis SIL, serif" text-anchor="middle">Back</text>

            <text x="0" y="80" font-size="24" font-family="Charis SIL, serif" text-anchor="left">Close</text>
            <text x="0" y="182" font-size="24" font-family="Charis SIL, serif" text-anchor="left">Close-mid</text>
            <text x="0" y="281" font-size="24" font-family="Charis SIL, serif" text-anchor="left">Open-mid</text>
            <text x="0" y="385" font-size="24" font-family="Charis SIL, serif" text-anchor="left">Open</text>





            <!-- Trapezoid Rows -->
            <line x1="150" y1="75" x2="600" y2="75" stroke="black" />
            <line x1="215" y1="175" x2="600" y2="175" stroke="black" />
            <line x1="282.5" y1="275" x2="600" y2="275" stroke="black" />
            <line x1="350" y1="375" x2="600" y2="375" stroke="black" />
            
            <!-- Trapezoid Columns -->
            <line x1="150" y1="75" x2="350" y2="375" stroke="black" />
            <line x1="600" y1="75" x2="600" y2="375" stroke="black" />
            <line x1="375" y1="75" x2="475" y2="375" stroke="black" />
            
            <!-- Nodes (solid dots) -->
            <!-- Top Row -->
            <circle cx="150" cy="75" r="5" class="node"/>
            <circle cx="375" cy="75" r="5" class="node"/>
            <circle cx="600" cy="75" r="5" class="node"/>
            
            <!-- Second Row -->
            <circle cx="215" cy="175" r="5" class="node"/>
            <circle cx="407.5" cy="175" r="5" class="node"/>
            <circle cx="600" cy="175" r="5" class="node"/>
            
            <!-- Third Row -->
            <circle cx="282.5" cy="275" r="5" class="node"/>
            <circle cx="441.25" cy="275" r="5" class="node"/>
            <circle cx="600" cy="275" r="5" class="node"/>
            
            <!-- Bottom Row -->
            <circle cx="350" cy="375" r="5" class="node"/>
            <circle cx="600" cy="375" r="5" class="node"/>
        </svg>
        


        <!-- Row 1 -->

        <input type="text" id="input1" style="left: 90px; top: 77px;">
        <input type="text" id="input2" style="left: 145px; top: 77px;">

        <input type="text" id="input3" style="left: 280px; top: 77px;">
        <input type="text" id="input4" style="left: 330px; top: 77px;">

        <input type="text" id="input5" style="left: 465px; top: 77px;">
        <input type="text" id="input6" style="left: 515px; top: 77px;">

        
        <!-- row 2 -->
        <input type="text" id="input7" style="left: 142px; top: 160px;">
        <input type="text" id="input8" style="left: 195px; top: 160px;">

        <input type="text" id="input9" style="left: 310px; top: 160px;">
        <input type="text" id="input10" style="left: 355px; top: 160px;">

        <input type="text" id="input11" style="left: 465px; top: 160px;">
        <input type="text" id="input12" style="left: 515px; top: 160px;">

        
        <!-- row 3 -->
        <input type="text" id="input13" style="left: 198px; top: 245px;">
        <input type="text" id="input14" style="left: 255px; top: 245px;">

        <input type="text" id="input15" style="left: 335px; top: 245px;">
        <input type="text" id="input16" style="left: 385px; top: 245px;">

        <input type="text" id="input17" style="left: 465px; top: 245px;">
        <input type="text" id="input18" style="left: 515px; top: 245px;">

        
        <!-- row 4 -->
        <input type="text" id="input19" style="left: 255px; top: 330px;">
        <input type="text" id="input20" style="left: 310px; top: 330px;">

        <input type="text" id="input21" style="left: 465px; top: 330px;">
        <input type="text" id="input22" style="left: 515px; top: 330px;">

        <!-- extras -->
        <input type="text" id="input23" style="left: 175px; top: 115px;">
        <input type="text" id="input24" style="left: 200px; top: 115px;">
        <input type="text" id="input25" style="left: 440px; top: 115px;">
        <input type="text" id="input26" style="left: 225px; top: 290px;">
        <input type="text" id="input27" style="left: 375px; top: 290px;">
        <input type="text" id="input28" style="left: 345px; top: 205px;">
    
    </div>

    <br />
    <button id="downloadButton">Save Chart as SVG</button>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Define phone symbols
        const phones = ['i', 'y', 'ɨ', 'ʉ', 'ɯ', 'u', 'e', 'ø', 'ɘ', 'ɵ', 'ɤ', 'o', 'ɛ', 'œ', 'ɜ', 'ɞ', 'ʌ', 'ɔ', 'a', 'ɶ', 'ɑ', 'ɒ', 'ɪ', 'ʏ', 'ʊ', 'æ', 'ɐ', 'ə'];

        // Set initial input values based on phone symbols
        phones.forEach((phone, index) => {
            document.getElementById('input' + String(index + 1)).value = phone;
        });

        // Function to update the SVG with input values
        function updateSVGWithInputValues() {
            const inputs = document.querySelectorAll('input');
            const svg = document.querySelector('svg');
            
            // Clear existing text elements in the SVG (if any)
            svg.querySelectorAll('.input-text').forEach(textElem => textElem.remove());
            
            // Loop over each input and add a text element to the SVG
            inputs.forEach(input => {
                const inputValue = input.value;

                // Create a background rectangle for non-empty input values
                if (inputValue !== "") {
                    const background = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                    background.setAttribute('x',1.175*parseFloat(input.style.left.replace('px', '')));
                    if (1.15* parseFloat(input.style.top.replace('px', '')) < 150 ){
                        background.setAttribute('y',0.90*parseFloat(input.style.top.replace('px','')));
                    } else {
                        background.setAttribute('y',1.05*parseFloat(input.style.top.replace('px','')));
                    }
                    background.setAttribute('width','25');
                    background.setAttribute('height','30');
                    background.setAttribute('fill','white');
                    svg.appendChild(background);
                    const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    text.setAttribute('x', 1.21*parseFloat(input.style.left.replace('px', '')));  // Set X for the text position
                    text.setAttribute('y', 1.15*parseFloat(input.style.top.replace('px', '')));  // Set Y for the text position
                    text.setAttribute('filter','url(#solid)')

                    text.setAttribute('class', 'input-text');
                    text.setAttribute('font-size', '24'); // Match font size with input
                    text.setAttribute('font-family', 'Charis SIL, serif'); // Match font family
                    text.setAttribute('text-anchor', 'middle'); // Center the text horizontally
                    text.textContent = inputValue;
                    svg.appendChild(text);
                }
            });
        }

        // Function to download the SVG with the input values
        function downloadSVG() {
            // Update SVG with input values before downloading
            updateSVGWithInputValues();

            // Serialize the updated SVG
            const svg = document.querySelector('svg');
            const serializer = new XMLSerializer();
            const svgData = serializer.serializeToString(svg);

            const blob = new Blob([svgData], { type: "image/svg+xml" });
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = 'vowel_trapezoid_with_labels.svg'; // Set file name for download
            a.click(); // Trigger download
            URL.revokeObjectURL(url); // Clean up URL object
        }

        // Trigger download when the button is clicked
        document.getElementById('downloadButton').addEventListener('click', downloadSVG);
    });
</script>


</body>
</html>
